<Window x:Class="AudioRichPresenceUI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:AudioRichPresenceUI"
        Title="Audio Rich Presence"
        Width="380"
        Height="410"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        SnapsToDevicePixels="True"
        UseLayoutRounding="True"
        TextOptions.TextFormattingMode="Display"
        TextOptions.TextRenderingMode="ClearType">

    <Window.Resources>
        <!-- Font -->
        <Style TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Segoe UI"/>
        </Style>

        <!-- Drop Shadows -->
        <DropShadowEffect x:Key="WindowShadow" BlurRadius="30" ShadowDepth="8" Opacity="0.5" Color="#000000"/>
        <DropShadowEffect x:Key="CardShadow" BlurRadius="10" ShadowDepth="2" Opacity="0.1" Color="#000000"/>
        
        <!-- Icons -->
        <!-- Fixed Apple Music Icon (Beamed Note) -->
        <Geometry x:Key="IconApple">M21.5,5.5 l-11,2.5 v9.1 c-0.8,-0.4 -1.8,-0.6 -3,-0.6 c-2.5,0 -4.5,2 -4.5,4.5 c0,2.5 2,4.5 4.5,4.5 c2.5,0 4.5,-2 4.5,-4.5 v-8.5 l9,-2 v6.5 c-0.8,-0.4 -1.8,-0.6 -3,-0.6 c-2.5,0 -4.5,2 -4.5,4.5 c0,2.5 2,4.5 4.5,4.5 c2.5,0 4.5,-2 4.5,-4.5 V5.5 z</Geometry>
        
        <!-- YouTube Icon (Standard Play Triangle) -->
        <Geometry x:Key="IconYoutube">M8,5v14l11-7L8,5z</Geometry>
        
        <!-- Eye Off Icon (Privacy) -->
        <Geometry x:Key="IconPrivacy">M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z</Geometry>
        
        <!-- Monitor Icon (System) -->
        <Geometry x:Key="IconSystem">M21 2H3c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h7l-2 3v1h8v-1l-2-3h7c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H3V4h18v12z</Geometry>

        <!-- Liquid Toggle Style -->
        <Style x:Key="LiquidToggle" TargetType="ToggleButton">
            <Setter Property="Width" Value="56"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToggleButton">
                        <Grid>
                            <Border x:Name="Track"
                                    CornerRadius="16"
                                    Background="#30000000"
                                    BorderBrush="#30FFFFFF"
                                    BorderThickness="1">
                                <Border.Triggers>
                                    <EventTrigger RoutedEvent="Border.Loaded">
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <ColorAnimation Storyboard.TargetName="Track"
                                                                Storyboard.TargetProperty="(Border.Background).(SolidColorBrush.Color)"
                                                                Duration="0:0:0.2"/>
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>
                                </Border.Triggers>
                            </Border>

                            <Ellipse x:Name="Thumb"
                                     Width="24" Height="24"
                                     Fill="#FFFFFFFF"
                                     HorizontalAlignment="Left"
                                     Margin="4,0,0,0">
                                <Ellipse.Effect>
                                    <DropShadowEffect BlurRadius="4" ShadowDepth="1" Opacity="0.2"/>
                                </Ellipse.Effect>
                                <Ellipse.RenderTransform>
                                    <TranslateTransform x:Name="ThumbTranslate" X="0"/>
                                </Ellipse.RenderTransform>
                            </Ellipse>
                        </Grid>

                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="Track" Property="BorderBrush" Value="#00000000"/>
                            </Trigger>

                            <EventTrigger RoutedEvent="ToggleButton.Checked">
                                <BeginStoryboard>
                                    <Storyboard>
                                        <!-- Vibrant Cyan/Green Active Color -->
                                        <ColorAnimation Storyboard.TargetName="Track"
                                                        Storyboard.TargetProperty="(Border.Background).(SolidColorBrush.Color)"
                                                        To="#FF00E0A0" Duration="0:0:0.3"/> 
                                        
                                        <DoubleAnimation Storyboard.TargetName="ThumbTranslate"
                                                         Storyboard.TargetProperty="X"
                                                         To="24" Duration="0:0:0.4">
                                            <DoubleAnimation.EasingFunction>
                                                <BackEase EasingMode="EaseOut" Amplitude="0.5"/>
                                            </DoubleAnimation.EasingFunction>
                                        </DoubleAnimation>
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>

                            <EventTrigger RoutedEvent="ToggleButton.Unchecked">
                                <BeginStoryboard>
                                    <Storyboard>
                                        <ColorAnimation Storyboard.TargetName="Track"
                                                        Storyboard.TargetProperty="(Border.Background).(SolidColorBrush.Color)"
                                                        To="#30000000" Duration="0:0:0.3"/>
                                        
                                        <DoubleAnimation Storyboard.TargetName="ThumbTranslate"
                                                         Storyboard.TargetProperty="X"
                                                         To="0" Duration="0:0:0.4">
                                            <DoubleAnimation.EasingFunction>
                                                <BackEase EasingMode="EaseOut" Amplitude="0.5"/>
                                            </DoubleAnimation.EasingFunction>
                                        </DoubleAnimation>
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

    </Window.Resources>

    <Grid>
        <!-- 1. Background Gradient (Breathing) -->
        <Border CornerRadius="20">
            <Border.Background>
                <LinearGradientBrush x:Name="LivingGradient" StartPoint="0,0" EndPoint="1,1">
                    <GradientStop Color="#FF0B1220" Offset="0.0"/>
                    <GradientStop Color="#FF1B2B6B" Offset="0.45"/>
                    <GradientStop Color="#FF6D28D9" Offset="1.0"/>
                </LinearGradientBrush>
            </Border.Background>
            <Border.Triggers>
                <EventTrigger RoutedEvent="Border.Loaded">
                    <BeginStoryboard>
                        <Storyboard RepeatBehavior="Forever" AutoReverse="True">
                            <ColorAnimation Storyboard.TargetName="LivingGradient"
                                            Storyboard.TargetProperty="GradientStops[1].Color"
                                            To="#FF2B3B7B" Duration="0:0:4"/>
                            <ColorAnimation Storyboard.TargetName="LivingGradient"
                                            Storyboard.TargetProperty="GradientStops[2].Color"
                                            To="#FF7D38E9" Duration="0:0:5"/>
                        </Storyboard>
                    </BeginStoryboard>
                </EventTrigger>
            </Border.Triggers>
        </Border>

        <!-- 2. Main Container -->
        <Border CornerRadius="20"
                BorderThickness="1"
                BorderBrush="#20FFFFFF"
                Effect="{StaticResource WindowShadow}"
                MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
            <Border.Background>
                <SolidColorBrush Color="#05FFFFFF"/>
            </Border.Background>

            <Grid Margin="16">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/> <!-- Header -->
                    <RowDefinition Height="*"/>    <!-- Content Stack -->
                </Grid.RowDefinitions>

                <!-- Header: Two buttons -->
                <Grid Grid.Row="0" Margin="0,0,0,16">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Title & Concise Badge -->
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock Text="Rich Presence"
                                   FontSize="20"
                                   FontWeight="Bold"
                                   Foreground="#FFFFFFFF"
                                   VerticalAlignment="Center"
                                   Margin="0,-2,0,0"/> <!-- Slight optical alignment -->
                        
                        <!-- Concise Status Badge -->
                        <Border x:Name="StatusBadge" Background="#1AFFFFFF" CornerRadius="10" Margin="12,0,0,0" Padding="8,4" VerticalAlignment="Center">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <Ellipse x:Name="StatusCircle" Width="6" Height="6" Fill="#FF808080" Margin="0,0,6,0" VerticalAlignment="Center"/>
                                <TextBlock x:Name="StatusText" 
                                           Text="KAPALI" 
                                           FontSize="9" 
                                           FontWeight="Black" 
                                           Foreground="#CCFFFFFF"
                                           VerticalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>

                    <!-- Buttons Area -->
                    <StackPanel Grid.Column="1" Orientation="Horizontal">
                        <!-- Minimize Button -->
                        <Button Width="28" Height="28"
                                Content="−"
                                FontSize="16"
                                Foreground="#CCFFFFFF"
                                Background="#1AFFFFFF"
                                BorderThickness="0"
                                Click="MinimizeButton_Click"
                                Cursor="Hand"
                                Margin="0,0,8,0">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border CornerRadius="14" Background="{TemplateBinding Background}">
                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Border>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>

                        <!-- Close Button -->
                        <Button Width="28" Height="28"
                                Content="✕"
                                FontSize="14"
                                Foreground="#CCFFFFFF"
                                Background="#1AFFFFFF"
                                BorderThickness="0"
                                Click="CloseButton_Click"
                                Cursor="Hand">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border CornerRadius="14" Background="{TemplateBinding Background}">
                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Border>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                    </StackPanel>
                </Grid>

                <!-- Content Stack -->
                <StackPanel Grid.Row="1">
                    
                    <TextBlock Text="ENTEGRASYONLAR" FontSize="10" FontWeight="Bold" Foreground="#80FFFFFF" Margin="4,0,0,6"/>

                    <!-- Integrations Card -->
                    <Border CornerRadius="16" Background="#15FFFFFF" BorderBrush="#15FFFFFF" BorderThickness="1" Margin="0,0,0,12">
                        <StackPanel Margin="12,10">
                            <!-- Apple Music Row -->
                            <Grid Height="48" Margin="0,0,0,6">
                                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                    <!-- Icon Box -->
                                    <Border Width="40" Height="40" CornerRadius="12" Background="#FFFF2D55" Margin="0,0,12,0">
                                        <Viewbox Width="20" Height="20">
                                            <Path Data="{StaticResource IconApple}" Fill="White" Stretch="Uniform"/>
                                        </Viewbox>
                                    </Border>
                                    <StackPanel VerticalAlignment="Center">
                                        <TextBlock Text="Apple Music" Foreground="White" FontSize="14" FontWeight="SemiBold"/>
                                        <TextBlock Text="Çalınan parçayı göster" Foreground="#90FFFFFF" FontSize="11"/>
                                    </StackPanel>
                                </StackPanel>
                                <ToggleButton x:Name="ToggleApple" HorizontalAlignment="Right" Style="{StaticResource LiquidToggle}" Click="Toggle_Click"/>
                            </Grid>

                            <!-- YouTube Row -->
                            <Grid Height="48">
                                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                    <!-- Icon Box -->
                                    <Border Width="40" Height="40" CornerRadius="12" Background="#FFFF0000" Margin="0,0,12,0">
                                        <Viewbox Width="12" Height="14" Margin="3,0,0,0"> <!-- Adjusted for play button center -->
                                            <Path Data="{StaticResource IconYoutube}" Fill="White" Stretch="Uniform"/>
                                        </Viewbox>
                                    </Border>
                                    <StackPanel VerticalAlignment="Center">
                                        <TextBlock Text="YouTube" Foreground="White" FontSize="14" FontWeight="SemiBold"/>
                                        <TextBlock Text="Video durumunu paylaş" Foreground="#90FFFFFF" FontSize="11"/>
                                    </StackPanel>
                                </StackPanel>
                                <ToggleButton x:Name="ToggleYoutube" HorizontalAlignment="Right" Style="{StaticResource LiquidToggle}" Click="Toggle_Click"/>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <TextBlock Text="GİZLİLİK" FontSize="10" FontWeight="Bold" Foreground="#80FFFFFF" Margin="4,0,0,6"/>

                    <!-- Privacy Card -->
                    <Border CornerRadius="16" Background="#15FFFFFF" BorderBrush="#15FFFFFF" BorderThickness="1" Margin="0,0,0,12">
                        <Grid Margin="12,8" Height="44">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <!-- Icon Box -->
                                <Border Width="40" Height="40" CornerRadius="12" Background="#30FFFFFF" Margin="0,0,12,0">
                                    <Viewbox Width="20" Height="20">
                                        <Path Data="{StaticResource IconPrivacy}" Fill="#DDFFFFFF"/>
                                    </Viewbox>
                                </Border>
                                <StackPanel VerticalAlignment="Center">
                                    <TextBlock Text="İçeriği Gizle" Foreground="White" FontSize="13" FontWeight="SemiBold"/>
                                    <TextBlock Text="YouTube detayları görünmez" Foreground="#90FFFFFF" FontSize="11"/>
                                </StackPanel>
                            </StackPanel>
                            
                            <CheckBox x:Name="PrivacyCheckBox"
                                      HorizontalAlignment="Right"
                                      Style="{StaticResource LiquidToggle}"
                                      Click="Toggle_Click"/>
                        </Grid>
                    </Border>
                    
                    <TextBlock Text="SİSTEM" FontSize="10" FontWeight="Bold" Foreground="#80FFFFFF" Margin="4,0,0,6"/>

                    <!-- System Card -->
                    <Border CornerRadius="16" Background="#15FFFFFF" BorderBrush="#15FFFFFF" BorderThickness="1">
                         <Grid Margin="12,8" Height="44">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <!-- Icon Box -->
                                <Border Width="40" Height="40" CornerRadius="12" Background="#FF3B82F6" Margin="0,0,12,0">
                                    <Viewbox Width="20" Height="20">
                                        <Path Data="{StaticResource IconSystem}" Fill="White"/>
                                    </Viewbox>
                                </Border>
                                <StackPanel VerticalAlignment="Center">
                                    <TextBlock Text="Windows ile Başlat" Foreground="White" FontSize="13" FontWeight="SemiBold"/>
                                    <TextBlock Text="PC açıldığında otomatik çalışır" Foreground="#90FFFFFF" FontSize="11"/>
                                </StackPanel>
                            </StackPanel>
                            
                             <!-- Reusing CheckBox logic for startup, but styled as Toggle -->
                             <CheckBox x:Name="StartupCheckBox"
                                       Style="{StaticResource LiquidToggle}"
                                       HorizontalAlignment="Right"
                                       Checked="StartupCheckBox_Changed"
                                       Unchecked="StartupCheckBox_Changed"/>
                        </Grid>
                    </Border>


                </StackPanel>
            </Grid>
        </Border>
        
        <!-- Logic Fix: Sync the Privacy ToggleButton with the Logic -->
        <!-- Since I put PrivacyCheckBox as collapsed, I need the ToggleButton 'TogglePrivacy' to drive it. 
             OR I can just style 'PrivacyCheckBox' directly with 'LiquidToggle' style. -> This is cleaner.
             Let me edit the 'Privacy Card' section above before writing file.
        -->
    </Grid>
</Window>
